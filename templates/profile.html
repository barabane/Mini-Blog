{% extends "base.html"%}
{% block title%}Profile{% endblock %}
{% block content%}
<div class="container-fluid">
  <div class="main-body">
    <div class="container">
      <div class="mb-3">
        <div class="card">
          <div class="card-body">
            <div class="d-flex flex-column align-items-center text-center">
              <img src="https://bootdey.com/img/Content/avatar/avatar7.png" class="rounded-circle"
                   width="150">
              <div class="mt-3">
                <h4 class="text-break">{{ current_user.email }}</h4>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="">
        <div class="card mb-3">
          <div class="card-body">
            <div class="row">
              <div class="col-sm-3">
                <h6 class="mb-0">Ваш ID</h6>
              </div>
              <div class="col-sm-9 text-secondary">
                {{ current_user.id }}
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <h6 class="mb-0">Email</h6>
              </div>
              <div class="col-sm-9 text-secondary">
                {{ current_user.email }}
              </div>
            </div>
          </div>
        </div>
        <div class="card mb-3">
          <div class="card-body">
            <h4>Написать пост</h4>
            <form method="POST" action="/profile">
              {{ form.csrf_token }}
              <div class="form-group mb-2">
                <label for="exampleInputEmail1">Заголовок поста</label>
                <input type="text" class="form-control" id="exampleInputEmail1" name="title">
              </div>
              <div class="form-group mb-3">
                <label for="exampleFormControlTextarea1">Содержание поста</label>
                <textarea class="form-control" id="exampleFormControlTextarea1" name="text" rows="3"></textarea>
              </div>
              <div class="input-group mb-3">
                <span class="input-group-text" id="hashtag">#</span>
                <input type="text" class="form-control" placeholder="Хештег" name="hashtag" aria-label="hashtag"
                       aria-describedby="hashtag">
              </div>
              <button type="submit" class="btn btn-primary">Опубликовать</button>
            </form>
          </div>
        </div>
        {% if posts != [] %}
        {% for post in posts%}
        <div class="card mb-4">
          <div class="card-body">
            <div class="small text-muted">{{ post.date.date() }}, {{ post.date.strftime("%H:%M")}}</div>
            <h2 class="card-title h4">{{ post.title }}</h2>
            {% if post.text|length < 200 %}
            <p class="card-text">{{ post.text }}</p>
            {% else %}
            <p class="card-text">{{ post.text[:100] }}...</p>
            {% endif %}
            <a class="btn btn-primary" href="/post/{{ post.id }}">Читать дальше →</a>
          </div>
        </div>
        {% endfor%}
        {% elif posts == [] %}
        <p class="text-center">У вас пока нет постов</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}